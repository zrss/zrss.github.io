---
title: 岁月无可回头(10)
tags:
  - 生活
categories: 笔记
abbrlink: 248b0a97
date: 2017-06-11 12:53:16
---

忙了一周 + 1 天，又是一个全员加班的周六

从上周六开始，独立维护了一套平台环境，验证服务升级部署

只能说进一步熟悉了业务

支撑了另外一个部门的服务部署，对面那哥们问我来多久了，我曰一个半月，对方回感觉都要成 xx 专家了，我曰怎么会，术业有专攻，对方回之前在哪儿待的，我曰啊，在学校呀，对方回天将降大任于斯人也

工作呀，对我来说，最需要成就感，哎，果然是个骄傲的不行的人，老师评价的不错，是得改改了，没必要和自己过不去

刚看了一个文档，终于理解了 etcd 的神逻辑。Disaster recovery 的时候，需要使用旧的数据 force-start-new 一个单节点集群，该集群正常启动后，将其 peer url 更新为对外 url，后继可正常添加成员

在 cluster-health 的情况下才可以 Member add。Member add 之前，删除其 data-dir，避免数据不一致

从 snapshot 恢复时，不用 force-start-new，因为 snapshot 没有集群 metadata，只有 key 数据

如果是数据从 v2 迁移至 v3，对 data-dir 执行 migrate 之后只是将 key data 转成了 mvcc 格式，而 cluster meta data 还是旧的，因此需要走 force new start 流程

如果是全新的集群启动，则所有 etcd 以 new 状态启动即可

这样就覆盖了所有流程

终于要去见来杭的 Gloria 了，据说为了见人，还特意剪了个发型，不过被剪成 SB 了，笑，等会儿看看有多惊艳

杭州应该进入了梅雨季节，一言不合就下雨，天气略闷热，而我的工作略忙

这篇在地铁，公交上写完

2017年06月11日12:53:16 杭州
